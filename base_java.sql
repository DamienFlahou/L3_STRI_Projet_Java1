-- MySQL Script generated by MySQL Workbench
-- dim. 24 mai 2015 18:25:12 CEST
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`Local`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Local` (
  `id_local` INT NOT NULL AUTO_INCREMENT,
  `nom_local` VARCHAR(45) NULL,
  PRIMARY KEY (`id_local`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Routeur`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Routeur` (
  `id_routeur` INT NOT NULL AUTO_INCREMENT,
  `id_salle` INT NULL,
  `nom_routeur` VARCHAR(45) NULL,
  `id_local` INT NULL,
  PRIMARY KEY (`id_routeur`),
  INDEX `fk_Routeur_1_idx` (`id_salle` ASC),
  INDEX `fk_Routeur_2_idx` (`id_local` ASC),
  CONSTRAINT `fk_Routeur_1`
    FOREIGN KEY (`id_salle`)
    REFERENCES `mydb`.`Salle` (`id_salle`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Routeur_2`
    FOREIGN KEY (`id_local`)
    REFERENCES `mydb`.`Local` (`id_local`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Switch`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Switch` (
  `id_switch` INT NOT NULL AUTO_INCREMENT,
  `id_routeur` INT NULL,
  `id_salle` INT NULL,
  `nom_switch` VARCHAR(45) NULL,
  `id_local` INT NULL,
  PRIMARY KEY (`id_switch`),
  INDEX `fk_Switch_1_idx` (`id_routeur` ASC),
  INDEX `fk_Switch_2_idx` (`id_salle` ASC),
  INDEX `fk_Switch_3_idx` (`id_local` ASC),
  CONSTRAINT `fk_Switch_1`
    FOREIGN KEY (`id_routeur`)
    REFERENCES `mydb`.`Routeur` (`id_routeur`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Switch_2`
    FOREIGN KEY (`id_salle`)
    REFERENCES `mydb`.`Salle` (`id_salle`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Switch_3`
    FOREIGN KEY (`id_local`)
    REFERENCES `mydb`.`Local` (`id_local`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Salle`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Salle` (
  `id_salle` INT NOT NULL AUTO_INCREMENT,
  `id_local` INT NULL,
  `id_routeur` INT NULL,
  `id_switch` INT NULL,
  `nom_salle` VARCHAR(45) NULL,
  PRIMARY KEY (`id_salle`),
  INDEX `fk_Salle_1_idx` (`id_local` ASC),
  INDEX `fk_Salle_2_idx` (`id_routeur` ASC),
  INDEX `fk_Salle_3_idx` (`id_switch` ASC),
  CONSTRAINT `fk_Salle_1`
    FOREIGN KEY (`id_local`)
    REFERENCES `mydb`.`Local` (`id_local`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Salle_2`
    FOREIGN KEY (`id_routeur`)
    REFERENCES `mydb`.`Routeur` (`id_routeur`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Salle_3`
    FOREIGN KEY (`id_switch`)
    REFERENCES `mydb`.`Switch` (`id_switch`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Ordinateur`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Ordinateur` (
  `id_ordinateur` INT NOT NULL AUTO_INCREMENT,
  `id_salle` INT NULL,
  `id_switch` INT NULL,
  `nom_ordinateur` VARCHAR(45) NULL,
  PRIMARY KEY (`id_ordinateur`),
  CONSTRAINT `fk_Ordinateur_1`
    FOREIGN KEY (`id_salle`)
    REFERENCES `mydb`.`Salle` (`id_salle`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Ordinateur_2`
    FOREIGN KEY (`id_switch`)
    REFERENCES `mydb`.`Switch` (`id_switch`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Carte_reseau`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Carte_reseau` (
  `id_carte_reseau` INT NOT NULL AUTO_INCREMENT,
  `id_ordinateur` INT NULL,
  `id_routeur` INT NULL,
  `adresse_mac` VARCHAR(45) NULL,
  PRIMARY KEY (`id_carte_reseau`),
  INDEX `fk_Carte_reseau_2_idx` (`id_routeur` ASC),
  CONSTRAINT `fk_Carte_reseau_1`
    FOREIGN KEY (`id_ordinateur`)
    REFERENCES `mydb`.`Ordinateur` (`id_ordinateur`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Carte_reseau_2`
    FOREIGN KEY (`id_routeur`)
    REFERENCES `mydb`.`Routeur` (`id_routeur`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- INSERT DE TEST
-- -----------------------------------------------------
SET foreign_key_checks = 0;

-- LOCAUX
INSERT INTO Local VALUES (1, 'Local1');
INSERT INTO Local VALUES (2, 'Local2');

-- ROUTEURS
INSERT INTO Routeur VALUES (1, 0, 'Routeur 1', 1);
INSERT INTO Routeur VALUES (2, 0, 'Routeur 2', 2);

-- SWITCH
INSERT INTO Switch VALUES (1, 1, 0, 'Switch1',1);
INSERT INTO Switch VALUES (2, 2, 0, 'Switch2',2);

-- SALLES
INSERT INTO Salle VALUES (1, 1, 1, 1, 'Salle 1.1');
INSERT INTO Salle VALUES (2, 1, 1, 1, 'Salle 1.2');
INSERT INTO Salle VALUES (3, 2, 2, 2, 'Salle 2.1');
INSERT INTO Salle VALUES (4, 2, 2, 2, 'Salle 2.2');

-- ORDINATEURS
INSERT INTO Ordinateur VALUES (1, 1, 1, 'Ordi1');
INSERT INTO Ordinateur VALUES (2, 1, 1, 'Ordi2');
INSERT INTO Ordinateur VALUES (3, 2, 1, 'Ordi3');
INSERT INTO Ordinateur VALUES (4, 2, 1, 'Ordi4');
INSERT INTO Ordinateur VALUES (5, 3, 2, 'Ordi5');
INSERT INTO Ordinateur VALUES (6, 3, 2, 'Ordi6');
INSERT INTO Ordinateur VALUES (7, 4, 2, 'Ordi7');
INSERT INTO Ordinateur VALUES (8, 4, 2, 'Ordi8');

-- CARTES RESEAUX
INSERT INTO Carte_reseau VALUES (1, 1, 0, '11:01:43:00:00:01');
INSERT INTO Carte_reseau VALUES (2, 1, 0, '11:01:43:00:00:02');
INSERT INTO Carte_reseau VALUES (3, 2, 0, '11:02:43:00:00:01');
INSERT INTO Carte_reseau VALUES (4, 2, 0, '11:02:43:00:00:02');
INSERT INTO Carte_reseau VALUES (5, 3, 0, '12:03:43:00:00:01');
INSERT INTO Carte_reseau VALUES (6, 3, 0, '12:03:43:00:00:02');
INSERT INTO Carte_reseau VALUES (7, 4, 0, '12:04:43:00:00:01');
INSERT INTO Carte_reseau VALUES (8, 4, 0, '12:04:43:00:00:02');
INSERT INTO Carte_reseau VALUES (9, 5, 0, '21:05:43:00:00:01');
INSERT INTO Carte_reseau VALUES (10, 5, 0, '21:05:43:00:00:02');
INSERT INTO Carte_reseau VALUES (11, 6, 0, '21:06:43:00:00:01');
INSERT INTO Carte_reseau VALUES (12, 6, 0, '21:06:43:00:00:02');
INSERT INTO Carte_reseau VALUES (13, 7, 0, '22:07:43:00:00:01');
INSERT INTO Carte_reseau VALUES (14, 7, 0, '22:07:43:00:00:02');
INSERT INTO Carte_reseau VALUES (15, 8, 0, '22:08:43:00:00:01');
INSERT INTO Carte_reseau VALUES (16, 8, 0, '22:08:43:00:00:02');

INSERT INTO Carte_reseau VALUES (17, 0, 1, '44:08:43:00:00:01');
INSERT INTO Carte_reseau VALUES (18, 0, 1, '44:08:43:00:00:02');
INSERT INTO Carte_reseau VALUES (19, 0, 2, '88:08:43:00:00:01');
INSERT INTO Carte_reseau VALUES (20, 0, 2, '88:08:43:00:00:02');

SET foreign_key_checks = 1;
